# 6-1 GANによる異常画像検知のメカニズム
- GANを用いた異常画像検出技術が必要とされる背景を理解
    - 異常画像検出の例：　（ルールベースの処理が難しく熟練者の経験に依存していた）
        - 医療画像から疾患と健常を判定
        - 製造業の部品検査で異常部品を検出
    - 異常検出の課題：異常画像が少ない(正常画像の数%以下)　→GANは正常画像だけで異常検出できる
- AnoGANのアルゴリズムを理解
    - 生成器Gと識別器Dを学習（P292 図6.1.2 上）
    - 生成器Gをつかって異常画像検出（P292 図6.1.2 下）
        - テストしたい画像から生成ノイズzを求める（詳細は6-2）
        - 求めた生成ノイズzから生成器Gで画像を生成
            - 正常：似た画像を生成できたもの
            - 異常：似た画像を生成できなかったもの

# 6-2 AnoGANの実装と異常検知の実施
- AnoGANでテスト画像に最も似た画像を生成するノイズzを求める方法を理解
    - 以下手順でノイズzを求める
        1. はじめに乱数でノイズzを生成　（本ではバッチ数5, 次元数20）
        2. ノイズzから画像を生成
        3. 生成画像とテスト画像のチャネルごとのピクセルの違いの絶対値和(residual loss)を算出
        4. 識別器Dでdiscrimination lossを算出(学習を効率化するため)
        5. 全体の損失関数lossを小さくするzを算出
    - 全体の損失関数 loss = (1-λ) × (residual loss) + λ × (discrimination loss)
        - residual loss: 生成器Gによる生成画像とテスト画像のピクセルごとの差の絶対値和
        - discrimination loss: 識別器Dに生成画像とテスト画像を入力した際の特徴量の違い
- AnoGANを実装し、手書き数字画像で異常検知が生成できる
    - 生成器Gと識別器Dの実装方法は基本的にDCGANと同じ
    - 識別器Dの出力が2種類
        - 0: 生成データ, 1: 教師データ, の判定(DCGANと同じ)
        - 上記の1つ前の特徴量も出力　(AnoGAN特有)
    - 学習、異常検知の実装例はP299-P302

# 6-3 Efficinet GANの概要 →AnoGANより短時間で異常検知可能
- テスト画像から生成ノイズを求めるエンコーダEをGANと同時に作ることが重要と理解する
    - AnoGANでは生成ノイズzの更新学習に時間がかかる
    - Efficient GANのエンコーダEで、テスト画像 → 生成ノイズzを生成
    - エンコーダEは、生成器Gや識別器Dと一緒に作るほうがよい(P304, 図6.3.1 実験的事実)
    - BiGAN (画像, ノイズz)のペアを識別器Dに入力して以下を見分ける(P307, 図6.3.2)
        - (x, E(x)) x：教師データ画像、E(x)：教師データの画像からエンコーダEで求めた入力ノイズz
        - (G(z), z) G(z)：生成機Gの生成画像、z：使用した入力ノイズz
    - BiGANのエンコーダーEは、識別器Dが(x, E(x))と(G(z), z)を識別できないように、識別器Dのlossの最大化をめざす
- Efficient GANのアルゴリズムを理解する
    - 損失関数
        - 生成器G, 識別器D：5章と同じ
        - エンコーダE：識別器Dが最小化するlossを最大化（識別できなくする）

# 6-4 Efficinet GANの実装と異常検知の実施
- Effient GANを実装し、手書き数字画像で異常検知が生成できる
    - 生成器Gは難しい点なし
    - 識別器Dの入力は、画像xとノイズz　→tourch.catで結合
    - エンコーダEの出力次元を入力ノイズzの次元数に設定
    - 画像データが少ない場合の学習率：
    　識別器D < 生成器G = エンコーダE